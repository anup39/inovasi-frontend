import { useEffect } from "react";
import Layout from "../components/commoncomp/Layout";
import MapComponent from "../map/Map";
import { Map } from "maplibre-gl";
import AddLayerAndSourceToMap from "../maputils/AddSourceAndLayer";

interface SupplierPlantationProps {
  map: Map | null;
  onSetMap: (evmap: Map) => void;
}
const SupplierPlantation: React.FC<SupplierPlantationProps> = ({
  map,
  onSetMap,
}) => {
  // const optionsReporting = ["Metric", "Mill Supplier"];

  useEffect(() => {
    if (map) {
      map.on("load", () => {
        AddLayerAndSourceToMap({
          map: map,
          layerId: "agriplot-layer",
          sourceId: "agriplot",
          url: `${
            import.meta.env.VITE_API_MAP_URL
          }/function_zxy_query_app_agriplot_by_estateids_and_wkt/{z}/{x}/{y}?estateids=["GEL13244","GEL13245","GEL07588"]&geometry_wkt=GEOMETRYCOLLECTION(POLYGON ((102.86806233582661 4.2045199886567275, 102.73198058956375 4.197842793199858, 102.59721554213458 4.177875852269068, 102.46507090217804 4.14481246113111, 102.33682454130637 4.098972649076156, 102.2137159313569 4.040800010769341, 102.09693400128762 3.9708573207500546, 101.98760554183797 3.889820980412195, 101.88678427669285 3.798474359150671, 101.79544070796672 3.6977001025320426, 101.7144528318086 3.5884714902065724, 101.64459780727286 3.4718429347524937, 101.586544648729 3.3489397197162374, 101.54084799937601 3.220947080822211, 101.50794303117944 3.08909873875223, 101.48814150497701 2.9546649951472475, 101.4816290137134 2.8189405056882246, 101.48846342178753 2.683231845396241, 101.50857450426187 2.548844981771034, 101.54176478105757 2.4170727711568936, 101.5877115330628 2.289182592850338, 101.64596997910876 2.16640423397619, 101.71597758481985 2.0499181360532823, 101.79705946624772 1.9408441114118367, 101.88843484282933 1.8402306341494525, 101.98922448550957 1.7490448060429733, 102.09845909685605 1.6681630926847955, 102.21508855076534 1.5983629190067914, 102.33799191008923 1.540315206233339, 102.46598813143218 1.4945779241371129, 102.59784735777423 1.4615907232651104, 102.73230269176491 1.4416707016097576, 102.86806233582661 1.4350093491187292, 103.0038219798883 1.4416707016097576, 103.13827731387896 1.46159072326511, 103.27013654022103 1.4945779241371129, 103.39813276156397 1.5403152062333385, 103.52103612088786 1.5983629190067912, 103.63766557479714 1.6681630926847955, 103.74690018614362 1.749044806042973, 103.84768982882389 1.8402306341494525, 103.93906520540548 1.9408441114118369, 104.02014708683335 2.0499181360532814, 104.09015469254443 2.1664042339761895, 104.1484131385904 2.2891825928503384, 104.19435989059563 2.4170727711568936, 104.22755016739134 2.5488449817710332, 104.24766124986566 2.683231845396241, 104.2544956579398 2.818940505688224, 104.24798316667618 2.9546649951472466, 104.22818164047375 3.08909873875223, 104.19527667227717 3.2209470808222105, 104.1495800229242 3.348939719716238, 104.09152686438033 3.4718429347524937, 104.02167183984459 3.5884714902065724, 103.94068396368647 3.6977001025320426, 103.84934039496034 3.798474359150671, 103.74851912981524 3.8898209804121944, 103.63919067036558 3.9708573207500546, 103.5224087402963 4.04080001076934, 103.39930013034683 4.098972649076157, 103.27105376947515 4.144812461131109, 103.13890912951861 4.177875852269068, 103.00414408208944 4.197842793199858, 102.86806233582661 4.2045199886567275)))`,

          source_layer: "function_zxy_query_app_agriplot_by_estateids_and_wkt",
          showPopup: true,
          style: {
            fill_color: "red",
            fill_opacity: "0",
            stroke_color: "black",
          },
          zoomToLayer: true,
          center: [103.8574, 2.2739],
          fillType: "fill",
          trace: false,
          component: "agriplot",
        });
      });
    }
  }, [map]);

  return (
    <Layout>
      <div className="flex flex-col h-[90vh]">
        <div className="flex-1">
          <MapComponent
            map={map}
            onSetMap={onSetMap}
            component="supplier-plantation"
          />
        </div>

        {/* <div className="mx-4 my-3 flex justify-between items-center">
          <Dropdown options={optionsReporting} placeholder="Metric" />
          <Pagination totalPages={50} />
        </div> */}
      </div>
    </Layout>
  );
};
export default SupplierPlantation;
